// vi:nu:et:sts=4 ts=4 sw=4
// See License.txt in main repository directory

// SQL Application main program

// Generated: [[Time]]
[[- $n := .TD.Data.TitledName]]

package main

import (
    "flag"
    "fmt"
    "log"
    "os"
)

var (
	debug    	bool
	force    	bool
	noop     	bool
	quiet    	bool
	db_pw       string
	db_port     string
	db_srvr     string
	db_user     string
	db_name     string
	http_srvr   string
	http_port   string
[[ if .TD.Main.Flags -]]
    [[GenVarDefns]]
[[- end -]]
)


[[ if .TD.Main.Usage ]]
func usage() {
    	fmt.Fprintf(flag.CommandLine.Output(), "Usage of %s:\n", os.Args[0])
    	[[ if .TD.Main.Usage.Line -]]
	        fmt.Fprintf(flag.CommandLine.Output(), "[[ .Usage.Line ]]\n")
        [[ end ]]
	    fmt.Fprintf(flag.CommandLine.Output(), "\nOptions:\n")
	    flag.PrintDefaults()
	    [[ if .TD.Main.Usage.Notes -]]
	        fmt.Fprintf(flag.CommandLine.Output(), "\nNotes:\n")
            [[ range $t := .TD.Main.Usage.Notes ]]
                fmt.Fprintf(flag.CommandLine.Output(), "[[ $t ]]")
            [[- end -]]
        [[ end ]]
}
[[- end ]]

func main() {

    // Set up flag variables
[[ if .TD.Main.Usage ]]
	flag.Usage = usage
[[ end -]]
	flag.BoolVar(&debug, "debug", true, "enable debugging")
	flag.BoolVar(&force, "force", true, "enable over-writes and deletions")
	flag.BoolVar(&force, "f", true, "enable over-writes and deletions")
	flag.BoolVar(&noop, "noop", true, "execute program, but do not make real changes")
	flag.BoolVar(&quiet, "quiet", true, "enable quiet mode")
	flag.BoolVar(&quiet, "q", true, "enable quiet mode")
[[ if .TD.Main.Flags -]]
    [[ GenFlagSetup ]]
[[ end -]]
[[ if eq .TD.Data.SqlType "sqlite" ]]
    flag.StringVar(&db_srvr, "dbServer", "test.db", "database file path")
[[ else ]]
    flag.StringVar(&db_pw,   "dbPW",    "Passw0rd!",    "the database password")
    flag.StringVar(&db_port, "dbPort",  "1433",         "the database port")
    flag.StringVar(&db_srvr, "dbServer", "localhost",   "the database server")
    flag.StringVar(&db_user, "dbUser",   "sa",          "the database user")
    flag.StringVar(&db_name, "dbName",   "",            "the database name")
[[ end ]]
	flag.StringVar(&http_port, "httpPort", "8080", "server port")
	flag.StringVar(&http_srvr, "httpServer", "localhost", "server site")

    // Parse the flags and check them
	flag.Parse()
	if debug {
		log.Println("\tIn Debug Mode...")
	}

    // Execute the main process.
	exec()
}


